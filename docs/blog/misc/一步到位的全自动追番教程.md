---
title: 一步到位的全自动追番教程
tags:
  - Linux
  - MoviePilot
  - Emby
  - qbittorrent
  - Docker
cover: https://s2.ixacg.com/2025/04/10/1744271581.avif
createTime: 2026/01/06 11:47:22
permalink: /blog/58nj2qii/
---



面对影视平台的各种广告，选择了自己搭建平台看剧，可以实现自动追番，高清画质，全平台播放，与朋友一起共享。

<!-- more -->

## 准备

* Nas或者自己的服务器
* ANI-RSS
* QB
* EMBY
* MP
* Autofilm(可选)

## qbittorrent

然后建立下载器，创建docker-compose.yml文件，内容如下

```dockerfile
version: "2"
services:
  qbittorrent:
    image: linuxserver/qbittorrent
    container_name: qbittorrent
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Shanghai # 你的时区
      - UMASK_SET=022
      - WEBUI_PORT=49850 # 将此处修改成你欲使用的 WEB 管理平台端口 
    volumes:
      - ./config:/config # 绝对路径请修改为自己的config文件夹
      - /data/downloads:/downloads # 绝对路径请修改为自己的downloads文件夹
    ports:
      # 要使用的映射下载端口与内部下载端口，可保持默认，安装完成后在管理页面仍然可以改成其他端口。
      - 49849:49849
      - 49849:49849/udp
      # 此处WEB UI 目标端口与内部端口务必保证相同，见问题1
      - 49850:49850
    restart: unless-stopped

```

## ANI-RSS

主要配合QB来实现番剧自动下载，和重命名，自动追番、订阅、下载 蜜柑RSS动漫。

![ani-rss界面](https://s2.ixacg.com/2025/04/10/1744271581.avif "1.1")​

创建docker-compose.yml文件，内容如下

```dockerfile
version: "3"
services:
  ani-rss:
    container_name: ani-rss
    volumes:
      - ./config:/config
      - /data/downloads:/downloads
    ports:
      - 7789:7789
    environment:
      - PORT=7789
      - CONFIG=/config
      - TZ=Asia/Shanghai
    restart: always
    image: wushuo894/ani-rss
```

缺点是暂时不支持聚合订阅，只能单个订阅。

![设置](https://s2.ixacg.com/2025/04/10/1744271620.avif "1.2")​

注意保存的位置需要与qbittorrent下载的位置一样。

当然你也可以将下载的影视上传到alist的第三方网盘。可以在其他服务端通过Autofile来创建strm，在用MoviePilot来刮削。

## MoviePilot

主要用来刮削，这里为了方便管理我采用strm硬链接的方式。

不使用emby刮削，主要是为了提高性能和速度.

MoviePilotV1与MoviePilotV2任选一个即可

### MoviePilotV1

创建docker-compose.yml文件，内容如下

```dockerfile
version: "2.3"
services:
  moviepilo:
    image: jxxghp/moviepilot:latest
    container_name: moviePilot
    environment:
      - UID=1000 
      - GID=1000 
      - UMASK=022
      - NGINX_PORT=3000
      - PORT=3001

      #代理 （用于连接tmdb、更新等）
    #   - PROXY_HOST=http://10.0.0.4:10080
    #   - MoviePilot_AUTO_UPDATE = ture
      #认证站点信息
      - AUTH_SITE=xxxxx
      - WINTERSAKURA_UID=xxxx
      - WINTERSAKURA_PASSKEY=xxxxx   

    volumes:

      # MoviePilot配置文件目录
      - ./moviepilot/main:/moviepilot #程序主目录，必选 【自行修改】
      - ./moviepilot/config:/config #config 配置文件，必选 【自行修改】
      # 媒体库目录
      - /data/downloads:/media # 记得这个路径就是上面qb设置的downloads路径 【自行修改】
    ports:
      - 3000:3000 # HTTP port
    restart: on-failure

```

在插件市场下载目录监控，设置如下图所示

![目录监控配置](https://s2.ixacg.com/2025/04/10/1744271660.webp)​

### MoviePilotV2

与V1相比，V2已经集成了目录监控功能。

创建docker-compose.yml文件，内容如下

```dockerfile
version: '3.3'

services:
    moviepilot:
        stdin_open: true
        tty: true
        container_name: moviepilot-v2
        hostname: moviepilot-v2
        networks:
            - moviepilot
        ports:
            - target: 13000
              published: 13000
              protocol: tcp
        volumes:
            - '/data/downloads:/media'
            - './moviepilot-v2/config:/config'
            - './moviepilot-v2/core:/moviepilot/.cache/ms-playwright'
            - './var/run/docker.sock:/var/run/docker.sock:ro'
            #- '/root/.config/rclone:/moviepilot/.config/rclone'
           # - '/alist:/alist'
            - '/data:/data'
        environment:
            - 'NGINX_PORT=13000'
            - 'PORT=13001'
            - 'PUID=0'
            - 'PGID=0'
            - 'UMASK=000'
            - 'TZ=Asia/Shanghai'
            - 'AUTH_SITE=xxxxx'
            - 'WINTERSAKURA_UID=xxxxx'
            - 'WINTERSAKURA_PASSKEY=xxxxx'
            - 'SUPERUSER=admin'
            # - 'API_TOKEN=无需手动配置，系统会自动生成。如果需要自定义配置，必须为16位以上的复杂字符串'
        restart: always
        image: jxxghp/moviepilot-v2:latest

networks:
  moviepilot:
    name: moviepilot
```

## EMBY

视频播放器，支持TV，安卓，苹果，PC播放，能够在线观看影视

创建docker-compose.yml文件，内容如下

```dockerfile
version: "2.3"
services:
    emby:
      image: amilys/embyserver:latest
      container_name: emby
      # network_mode: host
      ports:
        - 8096:8096
        - 8920:8920
        - 1900:1900/udp
        - 7359:7359/udp
      environment:
        - PUID=1000
        - PGID=1000
        - GIDLIST=0
        - TZ=Asia/Shanghai
        # - HTTP_PROXY="http://你的代理IP:端口/"
        # - HTTPS_PROXY="http://你的代理IP:端口/"
    #   devices:
    #     - /dev/dri:/dev/dri
      volumes:
        - ./emby:/config
        - /data/downloads:/media
        # - /alist:/alist
      
      restart: unless-stopped
```

设置媒体库目录

![媒体目录](https://s2.ixacg.com/2025/04/10/1744271683.avif)​

只需要勾选三图三个即可，其他无需勾选。

![媒体设置](https://s2.ixacg.com/2025/04/10/1744271697.avif)​

## Autofilm(可选)

如果你需要在另外一台服务器上配置EMBY播放视频，你可能需要在另外的服务器上用到autofile，它需要搭配alist使用

创建docker-compose.yml文件，内容如下

```dockerfile
version: '3.8'

services:
  autofilm:
    image: akimio/autofilm
    container_name: autofilm
    volumes:
      - ./config:/config
      - /data/downloads/video:/media
      - ./logs:/logs
    restart: always
```

进入config文件夹创建config.yaml，配置如下

```yaml
Settings:
  DEV: False                          # 开发者模式(可选，默认 False)

#将alsit上的文件strm下来
Alist2StrmList:
  - id: 动漫                          # 标识 ID
    cron: 54 15 * * *                  # 后台定时任务 Crontable 表达式
    url: xxxxx    # Alist 服务器地址，域名需要ws支持
    username: xxxxx                   # Alist 用户名
    password: xxxxx              # Alist 密码
    source_dir: /Anime                 # Alist 服务器上文件夹路径
    target_dir: /media/strm             # 输出路径
    flatten_mode: False               # 平铺模式，开启后 subtitle、image、nfo 强制关闭(可选，默认 False)
    subtitle: False                 # 是否下载字幕文件（可选，默认 False）
    image: False                      # 是否下载图片文件（可选，默认 False）
    nfo: False                        # 是否下载 .nfo 文件（可选，默认 False）
    raw_url: False                    # 是否使用原始地址替换 Alist 服务器下载地址（可选，默认 False）
    overwrite: False
    # 覆盖模式，本地路径存在同名文件时是否重新生成/下载该文件（可选，默认 False）
    other_ext:                        # 自定义下载后缀，使用西文半角逗号进行分割，（可选，默认为空）
    max_workers: 5                    # 下载文件最大并发数（可选，默认 5）
    url_encode: True                  # 是否对生成的strm文件中的链接进行URL编码
  

# 推荐删除
#Ani2AlistList:
#  - id: 新番追更                           # 标识 ID
#    cron: 33 15 * * *                     # 后台定时任务 Crontable 表达式
#    url: xxxxx      # Alist 服务器地址
#    username: xxx                       # Alist 用户名（需管理员权限）
#    password: xxxx                   # Alist 密码
#    target_dir: /Anime            # Alist 地址树存储器路径，若存储器不存在将自动创建（可选，默认/Anime）
#    rss_update: True                    # 使用 RSS 订阅更新最新番剧，启用后忽视传入的 year 和 month（可选，默认为 True）
#    year: 2024                            # 动漫季度-年份，仅支持 2019-1 及以后更新的番剧（可选，默认使用当前日期）
#    month: 10                           # 动漫季度-月份，仅支持 2019-1 及以后更新的番剧（可选，默认使用当前日期）
#    src_domain: openani.an-i.workers.dev # ANI Open 项目域名（可选，默认为 aniopen.an-i.workers.dev）
#    rss_domain: api.ani.rip               # ANI Open 项目 RSS 订阅域名（可选，默认为 api.ani.rip） 


```

接下来重复MoviePilot进行刮削

## 注意事项

### MoviePilot与qbittorrent密码在哪？

```dockerfile
docker logs <容器ID或容器名称> #查看密码
```

### 下载目录，媒体目录

需要注意所有的挂载目录在同一位置

## 参考

* [ANI-RSS](https://github.com/wushuo894/ani-rss)
* [EMBY](https://hub.docker.com/r/amilys/embyserver)
* [MoviePilot Wiki](https://wiki.movie-pilot.org/zh/reorganize)
* [Autofilm](https://github.com/Akimio521/AutoFilm)

‍
